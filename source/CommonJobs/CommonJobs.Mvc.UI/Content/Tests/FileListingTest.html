<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>FileListing.js unit tests</title>
    <link href="qunit/qunit.css" media="screen" rel="stylesheet" />
    
    <script src="../../Scripts/jquery-1.7.1.js" type="text/javascript"></script>
    <script src="../../Scripts/underscore.js" type="text/javascript"></script>
    <script src="../../Scripts/url-generator.js" type="text/javascript"></script>
    <script src="qunit/qunit.js" type="text/javascript"></script>

    <script src="../ListingCommon/QuickSearch.js" type="text/javascript"></script>
    <script src="../FilesListing/FilesListing.js" type="text/javascript"></script>

    <script>
        $(function () {
            module("FileSearchUtilities.fileIconFromExtension");
            test("works for null filename", function () {
                var fileName = null;
                var result = FileSearchUtilities.fileIconFromExtension(fileName);
                notEqual(result, null, "does not return null");
                notEqual(result.indexOf("unknown.png"), -1, "returns unknown.png");
            });

            test("extensions with their icons", function () {
                var extensions = ['avi', 'bmp', 'doc', 'docx', 'gif', 'jpeg', 'jpg', 'mov', 'mp3',
                    'mpeg', 'mpg', 'pdf', 'png', 'ppt', 'pptx', 'rar', 'txt', 'wmv', 'xls', 'xlsx', 'zip'];
                $.each(extensions, function () {
                    var ext = this;
                    var result = FileSearchUtilities.fileIconFromExtension(ext);
                    notEqual(result.indexOf(ext + ".png"), -1, "supports " + ext);
                });
            });


            module("FileSearchUtilities.urlToRelatedEntity");
            test("works for null relatedEntityId", function () {
                var relatedEntityId = null;
                var relatedEntityType = "Applicant";

                var result = FileSearchUtilities.urlToRelatedEntity(relatedEntityId, relatedEntityType);
                equal(result, null, "returns null");
            });
            test("Applicant entity type", function () {
                var relatedEntityId = "app/myId15";
                var relatedEntityType = "CommonJobs.Domain.Applicant";

                var result = FileSearchUtilities.urlToRelatedEntity(relatedEntityId, relatedEntityType);

                notEqual(result, null, "result is not null");
                notEqual(result.indexOf("/Applicants/"), -1, "contains the applicants path");
                notEqual(result.indexOf("/Edit/"), -1, "contains the applicant edition path");
                notEqual(result.indexOf(relatedEntityId), -1, "contains a reference to the related entity ID");
            });
            test("Employee entity type", function () {
                var relatedEntityId = "app/myId15";
                var relatedEntityType = "CommonJobs.Domain.Employee";

                var result = FileSearchUtilities.urlToRelatedEntity(relatedEntityId, relatedEntityType);

                notEqual(result, null, "result is not null");
                notEqual(result.indexOf("/Employees/"), -1, "contains the applicants path");
                notEqual(result.indexOf("/Edit/"), -1, "contains the applicant edition path");
                notEqual(result.indexOf(relatedEntityId), -1, "contains a reference to the related entity ID");
            });

            module("FileSearchUtilities.urlToFile");
            test("works for not null attachment id", function () {
                var attachmentId = "myAttachment/1235";
                var result = FileSearchUtilities.urlToFile(attachmentId);

                notEqual(result, null, "is not null");
                notEqual(result.indexOf("/Attachments/"), -1, "contains a reference to the attachments section");
                notEqual(result.indexOf("/Get/"), -1, "contains a reference to the Get action");
                notEqual(attachmentId, -1, "contains a reference to the attachment ID");
            });
        });
    </script>
</head>

<body>
    <h1 id="qunit-header">QUnit example</h1>
    <h2 id="qunit-banner"></h2>
    <div id="qunit-testrunner-toolbar"></div>
    <h2 id="qunit-userAgent"></h2>
    <ol id="qunit-tests"></ol>
    <!--<div id="qunit-fixture"></div>-->
</body>
</html>
