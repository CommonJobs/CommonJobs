using System;
using CommonJobs.ContentExtraction.Extractors;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace CommonJobs.ContentExtraction.IFilterExtraction.Test
{
    [TestClass]
    public class TestRegistroEntrevista
    {
        const string expected = "Registro de entrevista\r\nFecha: 14 de enero de 2012\r\nNombre y Apellido del postulante: X\r\nPuesto: Desarrollador Net \r\nEmpresa: Common Sense\r\nGrado: A: Alto/ MB: Muy bueno/ B: Bueno/ C: Mínimo necesario\r\nCaracterísticas generales\r\nEdad\r\n28\r\nEstado civil\r\nSoltero\r\nHijos\r\n0\r\nExpresión verbal\r\nMB\r\nModales y nivel cultural\r\nMB\r\nControl de ansiedad\r\nMB\r\nManejo de situación de entrevista\r\nMB\r\nMotivación para el puesto\r\nMB\r\nCompetencias técnicas para el puesto\r\nFormación\r\n-Graduado de la Carrera de Analista en Programación Universitaria\r\n-Falta entregar tesis en Mayo para recibirse de la carrera de Ingeniería en Sistemas\r\nAmbas cursadas en la Universidad Nacional del Centro de la Provincia de Bs As\r\nExperiencia requerida en - \r\n-POO Nivel intermedio-Alto\r\n-Base de datos SQL Server 2005-2008 Nivel intermedio-Alto\r\n-HTML-XHTML-JAVASCRIPTS Nivel intermedio-Alto\r\n-C# Nivel Alto\r\n-NET 1.1, 2.0,3.0,3.5,4.0 (actualmente está trabajando con 4.0) Nivel Alto\r\nNo posee experiencia en - \r\nC++ (sólo conocimientos teóricos)\r\nJAVA (sólo conocimientos teóricos . Está preparando su tesis de la facultad en esta tecnología)\r\nExperiencia en funciones a desarrollar\r\n-Desarrollo de aplicaciones Web. Nivel Alto\r\n-Análisis de Requerimientos. Nivel Alto\r\n-Testing de los desarrollos efectuados (Es estático, realiza revisación de código) Nivel intermedio-alto\r\nDominio del Idioma Ingles\r\nIntermedio (de uso actual más escrito que oral) \r\nCompetencias actitudinales\r\nOrientación a resultados\r\nA\r\nCapacidad de precisión\r\nMB\r\nOrganización y Planificación\r\nMB\r\nOrientación al cliente interno y externo\r\nMB\r\nDinamismo y pro-actividad\r\nMB\r\nCapacidad para comunicar avances y resultados\r\nMB\r\nTrabajo en equipo\r\nMB\r\nEVALUACION FINAL\r\nAlto\r\nMuy bueno\r\nBueno\r\nMínimo necesario\r\nx \r\nPretensión salarial y beneficios:\r\nA definir\r\nOtros\r\nTiene OSDE 210\r\nContinúa proceso\r\nSi\r\nTrayectoria laboral: \r\nX inició su carrera laboral en Marzo de 2007 tras ingresar por medio de la recomendación de un amigo a trabajar a Accendra , empresa que tiempo después fue comprada por Globant, donde se encuentra trabajando actualmente .Allí fue asignado a un puesto de Desarrollador Net Jr y fue capacitado desde cero en la función.\r\nPrimero fue asignado a proyectos cortos en punto net para clientes como Banco Comafi, ING, Epson, HP y desde hace 3 años hasta Marzo de este año está trabajando para la empresa Deloitte en distintos proyectos de mantenimiento y desarrollo de distintas aplicaciones para por ej el área de impuestos o internas de la empresa como redes sociales, evaluación de personal y otras de recursos humanos. Le ponen objetivos por semestre y tiene una evaluación de desempeño anual y una autoevaluación por la que cobra un bono anual. Le gusta mucho su trabajo porque es muy dinámico ya que siempre trabajan con la última tecnología. El único motivo por el que quiere irse es netamente económico porque considera que al ser una empresa grande los manejos son muy burocráticos y él hace un año que pide aumento de sueldo y no obtuvo nada aún, incluso al estar haciendo tareas como una especie de líder técnico ya que el le asigna tareas a 2ó 3 personas que tiene a cargo de acuerdo al proyecto y en base a los requerimientos. También es él quien estima los tiempos en coordinación con el equipo de trabajo .\r\nParalelamente X entre Enero y Octubre del 2008 trabajó con un compañero de Globant para distintos proyectos free lance para Ken Huang por medio de un contacto en USA que le pasaba los trabajos que el no quería hacer. Allí realizó tareas de desarrollo de aplicaciones, arquitecturas, maquetados, etc. Lo dejó cuando se terminaron los proyectos \r\nTambién en forma paralela después de su horario laboral entre Diciembre de 2009 y Octubre de 2010 trabajó como Desarrollador Net para la empresa Innovar en Tandil. Llegó allí al ser contactado por el dueño de la misma que era un conocido del club donde el jugaba al rugby y trabajó realizando aplicaciones para el Gobierno de la Pcia de Bs As trabajando para las empresas Birchman y el IOMA. Cuando aumentó el volumen de trabajo le contrataron una persona más para que lo ayude y él seguía manteniendo la comunicación con el cliente y siendo el responsable del todo el desarrollo. Decidió llegar a un acuerdo y renunciar ya que cobraba cada trabajo a los 70 días y se le hacia insostenible. El tema de la demora en los pagos era porque el Gobierno contrataba a la UTN y esta a su vez contrataba a Innovar y asi la cadena de pagos se hacia interminable.\r\nPerfil Actitudinal: \r\nRealizamos una entrevista por skype que pudo iniciarse en el horario pactado sin problemas, incluso X estaba esperando 20 minutos antes\r\nEn lo personal se considera proactivo, resolutivo y dinámico con gran capacidad de aprendizaje y adaptación. \r\nCree que debería mejorar su temperamento frente a la falta de compromiso de los otros en el trabajo porque es algo que le cuesta mucho como por ej llevar un demo a un cliente y que no le funcione porque un compañero no hizo su trabajo en tiempo y forma. Para prevenirse hoy por hoy revisa todo con anterioridad pero cree que lo ideal seria poder confiar en el trabajo de los otros\r\nNo le resulta difícil en la práctica estimar los tiempos\r\nInformación personal: \r\nX tiene 28 años, es soltero , está de novio y vive sólo en Tandil. Nació en Balcarce y se fue a vivir a Tandil cuando empezó su carrera universitaria y le encantó como ciudad para vivir. \r\nEstá terminando de armar su tesis en JAVA para entregarla en Mayo de este año y recibirse de Ingeniero en Sistemas. Eligió su carrera porque de chico estaba mucho con su tío que es Ingeniero en sistemas\r\nTiene un nivel intermedio de inglés .Usa el escrito todo el tiempo y el oral en los meetings. \r\nQuiere trabajar en las oficinas de Tandil\r\nSu horario disponible para hacer entrevistas es preferentemente después de las 18 sino en el horario del mediodía\r\nTiene planeadas vacaciones una semana en el invierno\r\n";

        [TestMethod]
        [DeploymentItem("Files\\Ejemplo de registro de entrevista.doc")]
        public void TestDoc()
        {
            ContentExtractionConfiguration.Current.Clear();
            ContentExtractionConfiguration.Current.AddRange(new IContentExtractor[] {
                new PlainTextContentExtractor(), //I prefeer my own plain text extractor than IFilter. It is ugly but it reads fine UTF8 without BOM files.
                new FilterContentExtractor()
            });
            var filename = "Ejemplo de registro de entrevista.doc";
            var configuration = ContentExtractionConfiguration.Current; //Default value
            var stream = new System.IO.FileStream(filename, System.IO.FileMode.Open);
            ExtractionResult result;
            if (configuration.TryExtract(filename, stream, filename, out result))
            {
                Assert.AreEqual(expected, result.PlainContent);
            }
            else
            {
                Assert.Fail("No result");
            }
        }

        [TestMethod]
        [DeploymentItem("Files\\Ejemplo de registro de entrevista.docx")]
        public void TestDocx()
        {
            ContentExtractionConfiguration.Current.Clear();
            ContentExtractionConfiguration.Current.AddRange(new IContentExtractor[] {
                new PlainTextContentExtractor(), //I prefeer my own plain text extractor than IFilter. It is ugly but it reads fine UTF8 without BOM files.
                new FilterContentExtractor()
            });
            var filename = "Ejemplo de registro de entrevista.docx";
            var configuration = ContentExtractionConfiguration.Current; //Default value
            var stream = new System.IO.FileStream(filename, System.IO.FileMode.Open);
            ExtractionResult result;
            if (configuration.TryExtract(filename, stream, filename, out result))
            {
                Assert.AreEqual(expected, result.PlainContent);
            }
            else
            {
                Assert.Fail("No result");
            }
        }

        [TestMethod]
        [DeploymentItem("Files\\Ejemplo de registro de entrevista.rtf")]
        public void TestRtf()
        {
            ContentExtractionConfiguration.Current.Clear();
            ContentExtractionConfiguration.Current.AddRange(new IContentExtractor[] {
                new PlainTextContentExtractor(), //I prefeer my own plain text extractor than IFilter. It is ugly but it reads fine UTF8 without BOM files.
                new FilterContentExtractor()
            });
            var filename = "Ejemplo de registro de entrevista.rtf";
            var configuration = ContentExtractionConfiguration.Current; //Default value
            var stream = new System.IO.FileStream(filename, System.IO.FileMode.Open);
            ExtractionResult result;
            if (configuration.TryExtract(filename, stream, filename, out result))
            {
                Assert.AreEqual(expected, result.PlainContent);
            }
            else
            {
                Assert.Fail("No result");
            }
        }
    }
}
